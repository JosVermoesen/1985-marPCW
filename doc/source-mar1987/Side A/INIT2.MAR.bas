1 ON ERROR GOTO 20000
10 REM INIT2.MAR=INITIALISEREN TELLERBESTAND DD
20 esc$=CHR$(27):rev$=esc$+"p":nrm$=esc$+"q":cls$=esc$+"E"+esc$+"H":on$=esc$+"e":off$=esc$+"f"
30 flash$=esc$+"p":flashoff$=esc$+"q":DEF FNat$(l,k,a$)=esc$+"Y"+CHR$(32+l)+CHR$(32+k)+a$:eol$=esc$+"K":hel$=esc$+"p":zcht$=esc$+"q"
70 OPTION RUN:
80 BUFFERS 6
90 IF FIND$("version.vsf")=""THEN RUN"menu.mar"ELSE OPEN"i",1,"version.vsf",2:INPUT #1,drive$:CLOSE 1
100 OPEN"R",1,drive$+"99.RND",30
110 FIELD 1,6 AS rec.nummer$
120 PRINT cls$
130 PRINT FNat$(0,0,"OPVR./WIJZ. TELLERS :")
140 PRINT FNat$(1,0,STRING$(80,172))
150 PRINT FNat$(2,0,"1. T AFAKT."):PRINT FNat$(3,0,"2. T ABOEK."):PRINT FNat$(4,0,"3. T CN/AF."):PRINT FNat$(5,0,"4. CN ABOEK"):PRINT FNat$(6,0,"5. BOEKJR."):PRINT FNat$(7,0,"6. JOURNAAL")
160 PRINT FNat$(8,0,"7. MEDEKTR."):PRINT FNat$(9,0,"8. IVERLHEF"):PRINT FNat$(10,0,"9. KLANTEN"):PRINT FNat$(11,0,"10.LEVERANC"):PRINT FNat$(12,0,"11.T VFAKT."):PRINT FNat$(13,0,"12.T VBOEK")
170 PRINT FNat$(14,0,"13.T CN/VF"):PRINT FNat$(15,0,"14.CN VBOEK"):PRINT FNat$(16,0,"16.BTW AF"):PRINT FNat$(17,0,"17.BTW KOST")
180 PRINT FNat$(18,0,"18.BTW VK"):PRINT FNat$(19,0,"19.HERZ.BTW"):PRINT FNat$(20,0,"20.DATUM"):PRINT FNat$(21,0,"21.VK 6 %"):PRINT FNat$(2,21,"22.VK 17 %")
190 PRINT FNat$(3,21,"23.VK 19 %"):PRINT FNat$(4,21,"24.VK 25 %"):PRINT FNat$(5,21,"25.VK UITVR")
200 PRINT FNat$(6,21,"27.BBETKORT"):PRINT FNat$(7,21,"28.TBETKORT.")
210 FOR t=2 TO 21:PRINT FNat$(t,12,":"):NEXT t
220 PRINT FNat$(8,21,"29.VK.MKTR."):PRINT FNat$(9,21,"30.TAKS 06"):PRINT FNat$(10,21,"31.T KASVER")
230 PRINT FNat$(11,21,"32.T POSTVR"):PRINT FNat$(12,21,"33.T BANK 1"):PRINT FNat$(13,21,"34.T BANK 2"):PRINT FNat$(14,21,"35.T BANK 3"):PRINT FNat$(15,21,"36.VK BK 7"):PRINT FNat$(16,21,"38.T TRANSF"):PRINT FNat$(17,21,"39.R TRANSF")
240 PRINT FNat$(18,21,"40.R CN VK"):PRINT FNat$(19,21,"41.R KAS"):PRINT FNat$(20,21,"42.R POST")
250 PRINT FNat$(21,21,"43.R BANK 1"):PRINT FNat$(2,40,"44.R BANK 2"):PRINT FNat$(3,40,"45.R BANK 3"):PRINT FNat$(4,40,"46.NAAM "):PRINT FNat$(5,40,"47.STRT NR."):PRINT FNat$(6,40,"48.STAD")
260 PRINT FNat$(7,40,"49.TELEFOON"):PRINT FNat$(8,40,"50.H.R. NR."):PRINT FNat$(9,40,"51.BTW NR."):PRINT FNat$(10,40,"52.BANK NR."):PRINT FNat$(11,40,"61.DSK KLT"):PRINT FNat$(12,40,"62.DSK LEV"):PRINT FNat$(13,40,"63.DSK REK"):
270 PRINT FNat$(14,40,"64.DSK ART"):PRINT FNat$(15,40,"65.DSK BTW"):PRINT FNat$(16,40,"66.DSK AFA"):PRINT FNat$(17,40,"67.DSK VFA"):PRINT FNat$(18,40,"68.DSK FREK"):PRINT FNat$(19,40,"69.DSK JOUR"):PRINT FNat$(20,40,"70.DSK TEL.")
271 PRINT FNat$(21,40,"72.FORM    :")
280 FOR t=2 TO 21:PRINT FNat$(t,32,":"):NEXT t
290 FOR t=2 TO 20:PRINT FNat$(t,51,":"):NEXT t
300 PRINT FNat$(22,0,STRING$(80,172))
310 PRINT hel$;:FOR t=1 TO 5:GET 1,t:PRINT FNat$(t+1,13,rec.nummer$):NEXT t
320 FOR t=6 TO 14:GET 1,t:PRINT FNat$(t+1,13,rec.nummer$):NEXT t
330 FOR t=16 TO 21:GET 1,t:PRINT FNat$(t,13,rec.nummer$):NEXT t
340 FOR t=22 TO 25:GET 1,t:PRINT FNat$(t-20,33,rec.nummer$):NEXT t
350 FOR t=27 TO 36:GET 1,t:PRINT FNat$(t-21,33,rec.nummer$):NEXT t
360 FOR t=38 TO 43:GET 1,t:PRINT FNat$(t-22,33,rec.nummer$):NEXT t
370 FOR t=44 TO 45:GET 1,t:PRINT FNat$(t-42,52,rec.nummer$):NEXT t
380 FIELD 1,28 AS rec.nummer$
390 FOR t=46 TO 52:GET 1,t:PRINT FNat$(t-42,52,rec.nummer$):NEXT t
400 FOR t=61 TO 70:GET 1,t:PRINT FNat$(t-50,52,rec.nummer$):NEXT t
401 FIELD 1,6 AS rec.nummer$:GET 1,72:PRINT FNat$(21,52,rec.nummer$);
410 PRINT zcht$;:PRINT FNat$(23,0,"DRUK <M> VOOR MENU - <W> VOOR WIJZIGEN");eol$;
420 antw$="MW":at$=UPPER$(INKEY$):IF INSTR(antw$,at$)=0 OR at$=""THEN 420
430 IF at$="M"THEN 550
440 PRINT FNat$(0,32,"NR.: ");hel$;:INPUT"",num$:IF num$=""THEN 530
450 IF VAL(num$)<45 OR VAL(num$)>70 THEN FIELD 1,6 AS rec.nummer$ELSE FIELD 1,28 AS rec.nummer$
460 GET 1,VAL(num$):PRINT FNat$(0,40,rec.nummer$);zcht$+"  (J/N)";
470 antw$="JN":at$=UPPER$(INKEY$):IF INSTR(antw$,at$)=0 OR at$=""THEN 470
480 IF at$="N"THEN 530
490 PRINT FNat$(0,32,"NIEUW :");eol$:PRINT FNat$(0,40,"");hel$;:INPUT"",nn$:PRINT zcht$;
500 IF nn$=""THEN 530
510 LSET rec.nummer$=nn$:PUT 1,VAL(num$)
520 GOTO 110
530 PRINT FNat$(0,32,eol$)
540 GOTO 410
550 RUN"menu.mar"
560 GOTO 560
20000 PRINT FNat$(23,0,"foutkode :");ERR
20010 PRINT FNat$(23,30,"<H>ERHALEN - <O>VERSLAAN - <M>ENU ?");eol$;
20020 antw$="HOM":at$=UPPER$(INKEY$):IF INSTR(antw$,at$)=0 OR at$=""THEN 20020
20030 IF at$="H"THEN RESUME ELSE IF at$="M"THEN 20040 ELSE RESUME NEXT
20040 CLOSE 1:CLOSE 2:CLOSE 3:RUN"menu.mar
HEN 20020
20030 IF at$="H"THEN RESUME ELSE IF at$="M"THEN 20040 ELSE RESUM